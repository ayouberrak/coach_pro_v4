{% extends "layouts/base.twig" %}

{% block title %}Réserver - {{ coach.lastName }} {{ coach.firstName }}{% endblock %}

{% block body %}
<div class="max-w-7xl mx-auto animate-fade-in pb-20">
    
    <div class="relative bg-darkCard border border-borderGray rounded-[3rem] p-8 md:p-12 overflow-hidden mb-10 shadow-2xl">
        <div class="absolute top-0 right-0 w-1/3 h-full bg-gradient-to-l from-primaryGold/5 to-transparent"></div>
        
        <div class="flex flex-col md:flex-row items-center gap-10 relative z-10">
            <div class="w-48 h-48 md:w-56 md:h-56 rounded-[3rem] overflow-hidden border-2 border-primaryGold p-1.5 bg-darkBg shadow-2xl">
                <img src="{{ coach.photoPath }}" class="w-full h-full object-cover rounded-[2.8rem]">
            </div>

            <div class="flex-1 text-center md:text-left">
                <div class="flex flex-wrap justify-center md:justify-start gap-3 mb-4">
                    <span class="bg-white/5 border border-borderGray text-gray-400 text-[9px] font-black px-3 py-1 rounded-full uppercase tracking-widest">{{ coach.anneeExperience }} Ans Expérience</span>
                </div>
                <h1 class="text-4xl md:text-5xl font-black text-white tracking-tighter uppercase mb-4 italic">
                    {{ coach.lastName }} <span class="text-primaryGold">{{ coach.firstName }}</span>
                </h1>
                <p class="text-gray-400 text-lg max-w-2xl font-medium leading-relaxed italic">
                    " {{ coach.biographie }} "
                </p>
            </div>
        </div>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-12 gap-10">
        
        <div class="lg:col-span-7 space-y-8">
            <div class="bg-darkCard border border-borderGray rounded-[2.5rem] p-8 shadow-xl">
                <div class="flex items-center gap-4 mb-8">
                    <div class="w-10 h-10 bg-primaryGold/10 rounded-xl flex items-center justify-center text-primaryGold">
                        <i class="fa-solid fa-calendar-days text-sm"></i>
                    </div>
                    <h3 class="text-xl font-black italic uppercase tracking-tighter text-white">Créneaux Disponibles</h3>
                </div>

                <p class="text-gray-500 text-xs font-bold uppercase tracking-widest mb-6 italic">Sélectionnez un créneau (Jour & Heure) :</p>
                
                <div class="grid grid-cols-2 sm:grid-cols-3 gap-4">
                    {# Exemple Manuel - Tu peux boucler ici si tu as une variable slots #}

                {%for disopFroma in disopFroma  %}
                    
                    <button type="button" onclick="selectSlot('{{disopFroma.date}}', '{{disopFroma.heure}}')" class="time-slot group bg-white/5 border border-borderGray p-4 rounded-2xl hover:border-primaryGold transition-all text-center">
                        <span class="block text-gray-400 font-bold text-[10px] uppercase mb-1">{{disopFroma.date}}</span>
                        <span class="block text-white font-black group-hover:text-primaryGold transition-colors text-lg italic">{{disopFroma.heure}}</span>
                        <span class="text-[9px] text-gray-600 font-bold uppercase">Matin</span>
                    </button>
                {% endfor %}

                </div>
            </div>

            <div class="bg-darkCard border border-borderGray rounded-[2.5rem] p-8">
                 <h3 class="text-white font-black text-sm uppercase tracking-widest mb-6">Certifications & Expertise</h3>
                 <div class="flex items-start gap-4 bg-white/5 p-5 rounded-[1.5rem] border border-borderGray/30">
                    <i class="fa-solid fa-award text-primaryGold text-2xl"></i>
                    <p class="text-gray-300 font-medium">{{ coach.certefications }}</p>
                 </div>
            </div>
        </div>

        <div class="lg:col-span-5">
            <div class="bg-darkCard border-2 border-primaryGold/30 rounded-[3rem] p-8 shadow-2xl sticky top-8">
                <h3 class="text-2xl font-black text-white italic uppercase tracking-tighter mb-8">Réserver ma <span class="text-primaryGold">Séance</span></h3>
                
                <form action="" method="POST" class="space-y-6">
                    <div class="grid grid-cols-2 gap-4">
                        <div class="space-y-2">
                            <label class="text-[10px] font-black text-gray-500 uppercase tracking-widest ml-2 italic">Date</label>
                            <input type="date" id="booking_date" name="date" required 
                                   class="w-full bg-darkInput border border-borderGray rounded-xl p-4 text-white text-xs font-bold focus:border-primaryGold outline-none">
                        </div>
                        <div class="space-y-2">
                            <label class="text-[10px] font-black text-gray-500 uppercase tracking-widest ml-2 italic">Heure</label>
                            <input type="time" id="booking_time" name="heure" required 
                                   class="w-full bg-darkInput border border-primaryGold/50 rounded-xl p-4 text-primaryGold text-xs font-bold focus:border-primaryGold outline-none">
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div class="space-y-2">
                            <label class="text-[10px] font-black text-gray-500 uppercase tracking-widest ml-2 italic">Durée</label>
                            <select name="duree" class="w-full bg-darkInput border border-borderGray rounded-xl p-4 text-white text-xs font-bold focus:border-primaryGold outline-none">
                                <option value="60">1 Heure</option>
                                <option value="90">1.5 Heure</option>
                                <option value="120">2 Heures</option>
                            </select>
                        </div>
                        <div class="space-y-2">
                            <label class="text-[10px] font-black text-gray-500 uppercase tracking-widest ml-2 italic">Type Sport</label>
                            <select name="sport" class="w-full bg-darkInput border border-borderGray rounded-xl p-4 text-white text-xs font-bold focus:border-primaryGold outline-none">
                                {% for sporte in sport %}
                                    <option value="{{sporte.id_sport}}">{{sporte.type}}</option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>

                    <div class="space-y-2">
                        <label class="text-[10px] font-black text-gray-500 uppercase tracking-widest ml-2 italic">Objectif de la séance</label>
                        <textarea name="description" placeholder="Ex: Focus sur les jambes et bas du corps..." rows="3" 
                                  class="w-full bg-darkInput border border-borderGray rounded-2xl p-4 text-white text-xs font-medium italic outline-none focus:border-primaryGold"></textarea>
                    </div>

                    <button type="submit" class="w-full bg-primaryGold hover:bg-white text-darkBg py-5 rounded-2xl font-black text-xs uppercase tracking-[0.2em] transition-all shadow-xl shadow-primaryGold/20 transform hover:-translate-y-1 mt-4">
                        Confirmer la Réservation
                    </button>
                    
                    <p class="text-[9px] text-gray-600 text-center uppercase font-black tracking-widest italic">Paiement sécurisé via CoachPro</p>
                </form>
            </div>
        </div>

    </div>
</div>

<script>
    /**
     * Gère la sélection automatique du jour et de l'heure
     * @param {string} date - Format YYYY-MM-DD
     * @param {string} time - Format HH:mm
     */
    function selectSlot(date, time) {
        // 1. On remplit les deux champs du formulaire
        document.getElementById('booking_date').value = date;
        document.getElementById('booking_time').value = time;
        
        // 2. Feedback visuel sur le bouton cliqué
        document.querySelectorAll('.time-slot').forEach(slot => {
            slot.classList.remove('border-primaryGold', 'bg-primaryGold/10', 'scale-95');
        });
        
        // On cible le bouton actuel via event.currentTarget
        const currentButton = event.currentTarget;
        currentButton.classList.add('border-primaryGold', 'bg-primaryGold/10', 'scale-95');
        
        // 3. Animation fluide vers le formulaire pour mobile
        if(window.innerWidth < 1024) {
            document.querySelector('form').scrollIntoView({ 
                behavior: 'smooth', 
                block: 'center' 
            });
        }
    }
</script>
{% endblock %}